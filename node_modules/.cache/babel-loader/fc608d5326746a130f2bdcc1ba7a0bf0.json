{"ast":null,"code":"var _jsxFileName = \"D:\\\\Julieth-Campos\\\\PSO\\\\src\\\\components\\\\FaceTrackerComponent.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef } from \"react\";\nimport \"./componentCSS/faceTrackerComponent.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst FaceTrackerComponent = props => {\n  _s();\n  const timeout = useRef(undefined);\n  const faceTracker = useRef(undefined);\n  const sdk_w = useRef(undefined);\n  const sdk_h = useRef(undefined);\n  useEffect(() => {\n    var _props$videoEl;\n    faceTracker.current = document.querySelector(\"#faceTracker\");\n    if (props !== null && props !== void 0 && (_props$videoEl = props.videoEl) !== null && _props$videoEl !== void 0 && _props$videoEl.current && faceTracker !== null && faceTracker !== void 0 && faceTracker.current) {\n      bindEvent();\n    }\n    function bindEvent() {\n      window.addEventListener(\"CY_FACE_DETECTOR_RESULT\", handleFaceEvents);\n      window.addEventListener(\"CY_CAMERA_RESULT\", setSdkDimensions);\n    }\n    function handleFaceEvents(evt) {\n      if (evt.detail && evt.detail.rects && evt.detail.rects.length > 0) {\n        const $vid = props.videoEl.current;\n        const scale_w = $vid.offsetWidth / sdk_w.current;\n        const scale_h = $vid.offsetHeight / sdk_h.current;\n        const y_diff = $vid.offsetHeight - sdk_h.current * 2;\n        const x_diff = $vid.offsetWidth - sdk_w.current * 2;\n        const offset_x = Math.round(x_diff / 2);\n        const offset_y = Math.round(y_diff / 2);\n        faceTracker.current.style.width = Math.round(evt.detail.rects[0].width * scale_w) + \"px\";\n        faceTracker.current.style.height = Math.round(evt.detail.rects[0].height * scale_h) + \"px\";\n        faceTracker.current.style.top = Math.round(evt.detail.rects[0].y * scale_h) + (y_diff > x_diff ? offset_y : 0) + \"px\";\n        faceTracker.current.style.left = Math.round(evt.detail.rects[0].x * scale_w) + (y_diff < x_diff ? offset_x : 0) + \"px\";\n        faceTracker.current.style.display = \"block\";\n        resetTimeout();\n      }\n    }\n    function setSdkDimensions(evt) {\n      sdk_w.current = evt.detail.width;\n      sdk_h.current = evt.detail.height;\n    }\n    function resetTimeout() {\n      let to = timeout.current;\n      clearTimeout(to);\n      to = setTimeout(() => {\n        setAllToZero();\n      }, 3000);\n      timeout.current = to;\n    }\n    function setAllToZero() {\n      faceTracker.current.style.display = \"none\";\n    }\n  }, [props === null || props === void 0 ? void 0 : props.videoEl]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"faceTrackerContainer\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"faceTracker\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n};\n_s(FaceTrackerComponent, \"f4WxOz0w6zWgEIMfPO8ONsfTRXA=\");\n_c = FaceTrackerComponent;\nexport default FaceTrackerComponent;\nvar _c;\n$RefreshReg$(_c, \"FaceTrackerComponent\");","map":{"version":3,"names":["useEffect","useRef","FaceTrackerComponent","props","timeout","undefined","faceTracker","sdk_w","sdk_h","current","document","querySelector","videoEl","bindEvent","window","addEventListener","handleFaceEvents","setSdkDimensions","evt","detail","rects","length","$vid","scale_w","offsetWidth","scale_h","offsetHeight","y_diff","x_diff","offset_x","Math","round","offset_y","style","width","height","top","y","left","x","display","resetTimeout","to","clearTimeout","setTimeout","setAllToZero"],"sources":["D:/Julieth-Campos/PSO/src/components/FaceTrackerComponent.js"],"sourcesContent":["import { useEffect, useRef } from \"react\";\r\nimport \"./componentCSS/faceTrackerComponent.css\"\r\n\r\n\r\nconst FaceTrackerComponent = (props) => {\r\n  const timeout = useRef(undefined);\r\n  const faceTracker= useRef(undefined);\r\n  const sdk_w = useRef(undefined);\r\n  const sdk_h = useRef(undefined);\r\n\r\n  useEffect(() => {\r\n    faceTracker.current = document.querySelector(\"#faceTracker\");\r\n    if(props?.videoEl?.current && faceTracker?.current){\r\n        bindEvent();\r\n    }\r\n    function bindEvent(){\r\n        \r\n        window.addEventListener(\r\n            \"CY_FACE_DETECTOR_RESULT\",\r\n            handleFaceEvents\r\n          );\r\n        window.addEventListener(\"CY_CAMERA_RESULT\", setSdkDimensions);\r\n    }\r\n\r\n    function handleFaceEvents (evt)  {\r\n        if (evt.detail && evt.detail.rects && evt.detail.rects.length > 0) {\r\n        const $vid = props.videoEl.current;\r\n\r\n        const scale_w = $vid.offsetWidth / sdk_w.current;\r\n        const scale_h = $vid.offsetHeight / sdk_h.current;\r\n\r\n        const y_diff = $vid.offsetHeight - (sdk_h.current*2);\r\n        const x_diff = $vid.offsetWidth - (sdk_w.current *2);\r\n\r\n        const offset_x = Math.round(x_diff / 2);\r\n        const offset_y = Math.round(y_diff / 2);\r\n        faceTracker.current.style.width =\r\n            Math.round(evt.detail.rects[0].width * scale_w) + \"px\";\r\n        faceTracker.current.style.height =\r\n            Math.round(evt.detail.rects[0].height * scale_h) + \"px\";\r\n        faceTracker.current.style.top =\r\n            Math.round(evt.detail.rects[0].y * scale_h) +\r\n            (y_diff > x_diff ? offset_y : 0) +\r\n            \"px\";\r\n        faceTracker.current.style.left =\r\n            Math.round(evt.detail.rects[0].x * scale_w) +\r\n            (y_diff < x_diff ? offset_x : 0) +\r\n            \"px\";\r\n\r\n        faceTracker.current.style.display = \"block\";\r\n        resetTimeout();\r\n        }\r\n        \r\n    }\r\n\r\n    function setSdkDimensions (evt) {\r\n        sdk_w.current= evt.detail.width;\r\n        sdk_h.current= evt.detail.height;\r\n    }\r\n\r\n    function resetTimeout() {\r\n    let to = timeout.current;\r\n    clearTimeout(to);\r\n    to =setTimeout(() => {\r\n        setAllToZero();\r\n    }, 3000)\r\n\r\n    timeout.current= to;\r\n    }\r\n    function setAllToZero () {\r\n    faceTracker.current.style.display = \"none\";\r\n    }\r\n\r\n  }, [props?.videoEl]);\r\n\r\n\r\n  \r\n\r\n\r\n\r\n  \r\n  return (\r\n    <>\r\n    <div id=\"faceTrackerContainer\">\r\n        <div id=\"faceTracker\"></div>\r\n    </div>\r\n    </>\r\n    \r\n  );\r\n};\r\n\r\nexport default FaceTrackerComponent;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}