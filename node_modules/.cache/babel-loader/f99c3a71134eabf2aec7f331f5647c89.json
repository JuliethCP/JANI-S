{"ast":null,"code":"/**\n * Copyright 2020 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { getFetch } from '../common/fetch.js';\nimport { debugError } from '../common/util.js';\nimport { isNode } from '../environment.js';\nimport { assert } from '../util/assert.js';\nimport { isErrorLike } from '../util/ErrorLike.js';\nimport { CdpBrowser } from './Browser.js';\nimport { Connection } from './Connection.js';\nconst getWebSocketTransportClass = async () => {\n  return isNode ? (await import('../node/NodeWebSocketTransport.js')).NodeWebSocketTransport : (await import('../common/BrowserWebSocketTransport.js')).BrowserWebSocketTransport;\n};\n/**\n * Users should never call this directly; it's called when calling\n * `puppeteer.connect`.\n *\n * @internal\n */\nexport async function _connectToCdpBrowser(options) {\n  const {\n    browserWSEndpoint,\n    browserURL,\n    ignoreHTTPSErrors = false,\n    defaultViewport = {\n      width: 800,\n      height: 600\n    },\n    transport,\n    headers = {},\n    slowMo = 0,\n    targetFilter,\n    _isPageTarget: isPageTarget,\n    protocolTimeout\n  } = options;\n  assert(Number(!!browserWSEndpoint) + Number(!!browserURL) + Number(!!transport) === 1, 'Exactly one of browserWSEndpoint, browserURL or transport must be passed to puppeteer.connect');\n  let connection;\n  if (transport) {\n    connection = new Connection('', transport, slowMo, protocolTimeout);\n  } else if (browserWSEndpoint) {\n    const WebSocketClass = await getWebSocketTransportClass();\n    const connectionTransport = await WebSocketClass.create(browserWSEndpoint, headers);\n    connection = new Connection(browserWSEndpoint, connectionTransport, slowMo, protocolTimeout);\n  } else if (browserURL) {\n    const connectionURL = await getWSEndpoint(browserURL);\n    const WebSocketClass = await getWebSocketTransportClass();\n    const connectionTransport = await WebSocketClass.create(connectionURL);\n    connection = new Connection(connectionURL, connectionTransport, slowMo, protocolTimeout);\n  }\n  const version = await connection.send('Browser.getVersion');\n  const product = version.product.toLowerCase().includes('firefox') ? 'firefox' : 'chrome';\n  const {\n    browserContextIds\n  } = await connection.send('Target.getBrowserContexts');\n  const browser = await CdpBrowser._create(product || 'chrome', connection, browserContextIds, ignoreHTTPSErrors, defaultViewport, undefined, () => {\n    return connection.send('Browser.close').catch(debugError);\n  }, targetFilter, isPageTarget);\n  return browser;\n}\nasync function getWSEndpoint(browserURL) {\n  const endpointURL = new URL('/json/version', browserURL);\n  const fetch = await getFetch();\n  try {\n    const result = await fetch(endpointURL.toString(), {\n      method: 'GET'\n    });\n    if (!result.ok) {\n      throw new Error(`HTTP ${result.statusText}`);\n    }\n    const data = await result.json();\n    return data.webSocketDebuggerUrl;\n  } catch (error) {\n    if (isErrorLike(error)) {\n      error.message = `Failed to fetch browser webSocket URL from ${endpointURL}: ` + error.message;\n    }\n    throw error;\n  }\n}","map":{"version":3,"mappings":"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","names":["getFetch","debugError","isNode","assert","isErrorLike","CdpBrowser","Connection","getWebSocketTransportClass","NodeWebSocketTransport","BrowserWebSocketTransport","_connectToCdpBrowser","options","browserWSEndpoint","browserURL","ignoreHTTPSErrors","defaultViewport","width","height","transport","headers","slowMo","targetFilter","_isPageTarget","isPageTarget","protocolTimeout","Number","connection","WebSocketClass","connectionTransport","create","connectionURL","getWSEndpoint","version","send","product","toLowerCase","includes","browserContextIds","browser","_create","undefined","catch","endpointURL","URL","fetch","result","toString","method","ok","Error","statusText","data","json","webSocketDebuggerUrl","error","message"],"sources":["D:\\Julieth-Campos\\PSO\\node_modules\\puppeteer-core\\src\\cdp\\BrowserConnector.ts"],"sourcesContent":["/**\n * Copyright 2020 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  IsPageTargetCallback,\n  TargetFilterCallback,\n} from '../api/Browser.js';\nimport type {ConnectionTransport} from '../common/ConnectionTransport.js';\nimport {getFetch} from '../common/fetch.js';\nimport {debugError} from '../common/util.js';\nimport type {Viewport} from '../common/Viewport.js';\nimport {isNode} from '../environment.js';\nimport {assert} from '../util/assert.js';\nimport {isErrorLike} from '../util/ErrorLike.js';\n\nimport {CdpBrowser} from './Browser.js';\nimport {Connection} from './Connection.js';\nimport type {ConnectOptions} from './Puppeteer.js';\n/**\n * Generic browser options that can be passed when launching any browser or when\n * connecting to an existing browser instance.\n * @public\n */\nexport interface BrowserConnectOptions {\n  /**\n   * Whether to ignore HTTPS errors during navigation.\n   * @defaultValue `false`\n   */\n  ignoreHTTPSErrors?: boolean;\n  /**\n   * Sets the viewport for each page.\n   */\n  defaultViewport?: Viewport | null;\n  /**\n   * Slows down Puppeteer operations by the specified amount of milliseconds to\n   * aid debugging.\n   */\n  slowMo?: number;\n  /**\n   * Callback to decide if Puppeteer should connect to a given target or not.\n   */\n  targetFilter?: TargetFilterCallback;\n  /**\n   * @internal\n   */\n  _isPageTarget?: IsPageTargetCallback;\n  /**\n   * @defaultValue 'cdp'\n   * @internal\n   */\n  protocol?: 'cdp' | 'webDriverBiDi';\n  /**\n   * Timeout setting for individual protocol (CDP) calls.\n   *\n   * @defaultValue `180_000`\n   */\n  protocolTimeout?: number;\n}\n\nconst getWebSocketTransportClass = async () => {\n  return isNode\n    ? (await import('../node/NodeWebSocketTransport.js')).NodeWebSocketTransport\n    : (await import('../common/BrowserWebSocketTransport.js'))\n        .BrowserWebSocketTransport;\n};\n\n/**\n * Users should never call this directly; it's called when calling\n * `puppeteer.connect`.\n *\n * @internal\n */\nexport async function _connectToCdpBrowser(\n  options: BrowserConnectOptions & ConnectOptions\n): Promise<CdpBrowser> {\n  const {\n    browserWSEndpoint,\n    browserURL,\n    ignoreHTTPSErrors = false,\n    defaultViewport = {width: 800, height: 600},\n    transport,\n    headers = {},\n    slowMo = 0,\n    targetFilter,\n    _isPageTarget: isPageTarget,\n    protocolTimeout,\n  } = options;\n\n  assert(\n    Number(!!browserWSEndpoint) + Number(!!browserURL) + Number(!!transport) ===\n      1,\n    'Exactly one of browserWSEndpoint, browserURL or transport must be passed to puppeteer.connect'\n  );\n\n  let connection!: Connection;\n  if (transport) {\n    connection = new Connection('', transport, slowMo, protocolTimeout);\n  } else if (browserWSEndpoint) {\n    const WebSocketClass = await getWebSocketTransportClass();\n    const connectionTransport: ConnectionTransport =\n      await WebSocketClass.create(browserWSEndpoint, headers);\n    connection = new Connection(\n      browserWSEndpoint,\n      connectionTransport,\n      slowMo,\n      protocolTimeout\n    );\n  } else if (browserURL) {\n    const connectionURL = await getWSEndpoint(browserURL);\n    const WebSocketClass = await getWebSocketTransportClass();\n    const connectionTransport: ConnectionTransport =\n      await WebSocketClass.create(connectionURL);\n    connection = new Connection(\n      connectionURL,\n      connectionTransport,\n      slowMo,\n      protocolTimeout\n    );\n  }\n  const version = await connection.send('Browser.getVersion');\n\n  const product = version.product.toLowerCase().includes('firefox')\n    ? 'firefox'\n    : 'chrome';\n\n  const {browserContextIds} = await connection.send(\n    'Target.getBrowserContexts'\n  );\n  const browser = await CdpBrowser._create(\n    product || 'chrome',\n    connection,\n    browserContextIds,\n    ignoreHTTPSErrors,\n    defaultViewport,\n    undefined,\n    () => {\n      return connection.send('Browser.close').catch(debugError);\n    },\n    targetFilter,\n    isPageTarget\n  );\n  return browser;\n}\n\nasync function getWSEndpoint(browserURL: string): Promise<string> {\n  const endpointURL = new URL('/json/version', browserURL);\n\n  const fetch = await getFetch();\n  try {\n    const result = await fetch(endpointURL.toString(), {\n      method: 'GET',\n    });\n    if (!result.ok) {\n      throw new Error(`HTTP ${result.statusText}`);\n    }\n    const data = await result.json();\n    return data.webSocketDebuggerUrl;\n  } catch (error) {\n    if (isErrorLike(error)) {\n      error.message =\n        `Failed to fetch browser webSocket URL from ${endpointURL}: ` +\n        error.message;\n    }\n    throw error;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}